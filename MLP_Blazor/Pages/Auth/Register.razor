@page "/auth/register"
@layout AuthLayout
@using MLP_DbLibrary.VM.UserVM
@using MLP_DbLibrary.DTO.UserDTO
@using AutoMapper

@inject HttpClient Client
@inject IMapper _mapper 


<div class="container">
    <h4>Register</h4>
    <EditForm Model="model" OnValidSubmit="RegisterUser">
        <DataAnnotationsValidator />
        <ValidationSummary  style="font-size:small"/>

        <div>
            <label class="label">Email</label>
            <input  type="text" placeholder="Enter Email" @bind-value="model.Email" />
        </div>
        <div>
            <label class="label" >Password</label>
            <input type="password" placeholder="Enter Password" @bind-value="model.Password" />
        </div>
        <div>
            <label class="label" >Confirm Password</label>
            <input type="password" placeholder="Confrim Password" @bind-value="model.PasswordConfirm" />
        </div>
        <div>
            <label class="label">First Name</label>
            <input type="text" placeholder="Enter First Name" @bind-value="model.FirstName" />
        </div>
        <div>
            <label class="label" >Last Name</label>
            <input type="text" placeholder="Enter Last Name" @bind-value="model.LastName" />
        </div>
        <div>
            <label class="label">Teacher</label>
            <input type="checkbox" @bind-value="model.IsTeacher" />
        </div>

        <br/>
              
        <div class="d-flex justify-content-center">
            <button class="btn-register" style="" type="submit">Register</button>            
        </div>
        <div class="d-flex justify-content-center"  style="font-size: small">
            Already have an account?
        </div>
        <div class="d-flex justify-content-center"  style="font-size: small">
            <a href="/auth/LogIn">Sign in</a>
        </div>
    </EditForm>
</div>


@code {
    RegisterUserVM model = new RegisterUserVM { IsAdmin = false};


    public async void RegisterUser()
    {
        var modelDTO = _mapper.Map<RegisterUserDTO>(model);
        var response = await Client.PostAsJsonAsync("https://localhost:44397/api/User/Register", modelDTO);
    }
}
